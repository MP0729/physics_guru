<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body onload="startTimer()" class="p-10">

<h1 class="text-2xl font-bold mb-4">{{ exam.title }}</h1>
<p id="timer" class="text-red-600 mb-4"></p>

<form method="POST" id="examForm">
{% csrf_token %}

{% for q in questions %}
<div class="mb-6 p-4 bg-white shadow rounded">
  <p class="font-bold">{{ q.question }}</p>

  <label><input type="radio" name="{{ q.id }}" value="A"> {{ q.option_a }}</label><br>
  <label><input type="radio" name="{{ q.id }}" value="B"> {{ q.option_b }}</label><br>
  <label><input type="radio" name="{{ q.id }}" value="C"> {{ q.option_c }}</label><br>
  <label><input type="radio" name="{{ q.id }}" value="D"> {{ q.option_d }}</label>

  <div class="mt-2">
    <button type="button" onclick="getHint({{ q.id }},1)">üí° Concept</button>
    <button type="button" onclick="getHint({{ q.id }},2)">üìê Formula</button>
    <button type="button" onclick="getHint({{ q.id }},3)">üß† Approach</button>
  </div>

  <p id="hint-{{ q.id }}" class="text-blue-600 mt-2"></p>
</div>
{% endfor %}

<button class="bg-green-600 text-white px-6 py-2 rounded">Submit</button>
</form>

<script>
let timeLeft = {{ duration }};
function startTimer(){
  setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").innerText = timeLeft + " seconds";
    if(timeLeft<=0){
      document.getElementById("examForm").submit();
    }
  },1000);
}

function getHint(id, level){
  fetch(`/hint/${id}/${level}/`)
    .then(r=>r.json())
    .then(d=>{
      document.getElementById(`hint-${id}`).innerText = d.hint;
    });
}
</script>

</body>
</html>